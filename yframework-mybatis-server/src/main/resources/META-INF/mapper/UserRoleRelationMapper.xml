<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cust.system.repository.UserRoleRelationRepository">
    <sql id="tableName">
        SYS_USER_ROLE
    </sql>

    <sql id="tableAlias">
        <include refid="tableName"/>
        o
    </sql>

    <sql id="columns">
        o.USER_ID AS userId,
        o.ROLE_ID AS roleId
    </sql>

    <sql id="joinTables">
    </sql>

    <sql id="joinColumns">
    </sql>

    <sql id="conditions">
    </sql>

    <insert id="save" parameterType="com.cust.system.domain.UserRoleRelation">
        INSERT INTO SYS_USER_ROLE (
        USER_ID,
        ROLE_ID
        )
        VALUES (
        #{userId},
        #{roleId}
        )
    </insert>

    <delete id="deleteByUserId" parameterType="java.lang.String">
        DELETE FROM SYS_USER_ROLE WHERE USER_ID = #{userId}
    </delete>

    <select id="findRolesIdByUserId" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT
        ur.ROLE_ID as roleId
        FROM
        SYS_USER_ROLE ur
        WHERE
        ur.USER_ID = #{uid}
    </select>

    <select id="findAllUserRoleRelation" resultType="com.cust.system.domain.UserRoleRelation">
        SELECT
        <include refid="columns"/>
        FROM
        <include refid="tableAlias"/>
        LEFT JOIN
        SYS_USER u
        ON o.USER_ID = u.ID
        WHERE
        u.ACTIVATED = '1'
    </select>

</mapper>
