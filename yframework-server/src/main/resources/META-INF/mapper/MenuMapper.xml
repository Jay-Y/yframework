<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cust.system.repository.MenuRepository">
    <sql id="tableName">
        SYS_MENU
    </sql>

    <sql id="tableAlias">
        <include refid="tableName"/>
        o
    </sql>

    <sql id="columns">
        o.ID AS id,
        o.CREATED_BY AS createdBy,
        o.CREATED_DATE AS createdDate,
        o.LAST_MODIFIED_BY AS lastModifiedBy,
        o.LAST_MODIFIED_DATE AS lastModifiedDate,
        o.ACTIVATED AS activated,
        o.NAME AS name,
        o.SORT AS sort,
        o.HREF AS href,
        o.ICON AS icon,
        o.PERMISSION AS permission,
        o.IS_SHOW AS isShow,
        o.PARENT_ID AS parentId
    </sql>

    <sql id="joinTables">
    </sql>

    <sql id="joinColumns">
    </sql>

    <sql id="conditions">
    </sql>

    <select id="findAllMenus" resultType="com.cust.system.domain.Menu">
        SELECT
        <include refid="columns"/>
        FROM
        <include refid="tableAlias"/>
        WHERE
        o.ACTIVATED = '1'
        ORDER BY o.PARENT_ID, o.SORT
    </select>

    <select id="findMenusByRoleId" parameterType="java.lang.String" resultType="com.cust.system.domain.Menu">
        SELECT
        <include refid="columns"/>
        FROM
        <include refid="tableAlias"/>
        LEFT JOIN SYS_ROLE_MENU rm
        ON o.ID = rm.MENU_ID
        WHERE
        rm.ROLE_ID = #{roleId}
        AND o.ACTIVATED = '1'
        ORDER BY o.PARENT_ID, o.SORT
    </select>


</mapper>
